@model _7Colors.ViewModels.MessageViewModel

@{

    ViewData["Title"] = "Send New Message";
}

<!-- page title -->
<section class="section bg-cover overlay" data-background="images/backgrounds/page-title.jpg">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h2 class="text-white mb-3">Contact Us</h2>
                <!-- breadcrumb -->
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb bg-transparent p-0">
                        <li class="breadcrumb-item font-weight-semebold"><a class="text-white" href="index.html">Home</a></li>
                        <li class="breadcrumb-item font-weight-semebold active text-primary" aria-current="page">Contact Us</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</section>
<!-- /page title -->
<section id="contact">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <h2 style="font:400 1.5em;color:black">I WOULD LIKE TO HEAR FROM YOU</h2>
                <hr class="star-primary">
            </div>
        </div>
        <div class="row">
            <div class="col-lg-6">
                <div class="js-tilt">
                    <img class="img-fluid" src="~/content/images/message.png" alt="Alternate Text" />
                </div>
            </div>
            <div class="col-lg-6">
                <div class="alert">Your message has been sent</div>

                <form asp-controller="Messages" asp-action="Create" method="post" id="signupform" autocomplete="off">
                    <input asp-for="Id" type="hidden" />
                    <div class="form-group">
                        <label>Name</label>
                        <input class="form-control" asp-for="Name" />
                        <span asp-validation-for="Name" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input class="form-control" asp-for="Email" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input class="form-control" asp-for="PhoneNumber" />
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea class="form-control" asp-for="Content">
                         </textarea>
                    </div>
                    @Html.AntiForgeryToken()
                    <button type="submit" class="btn btn-primary btn-lg">Send Message</button>
                </form>
            </div>
        </div>
    </div><!--container-->
</section>

@section scripts {
    <script src="~/js/mymessage.js"></script>
    <script>
        let submitForm = document.querySelector("#signupform");
        submitForm.addEventListener("submit", submitData);

        function submitData(e) {
            e.preventDefault();

            //Get values
            let name, email, message;
            name = document.getElementById("Name").value;
            email = document.getElementById("Email").value;
            phone = document.getElementById("PhoneNumber").value;
            message = document.getElementById("Content").value;

            if (name === "") {
                alert("Please enter your name !!!");
                return false;
            };
            if (email === "") {
                alert("Please enter your email !!!");
                return false;
            };
            if (phone === "") {
                alert("Please enter your PhoneNumber !!!");
                return false;
            };
            if (message === "") {
                alert("Please enter your Message !!!");
                return false;
            };

            fetch('/UI/MyMessages/Create', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json, text/plain, */*',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: name, email: email, phoneNumber: phone, message: message })
            }).then((res) => res.json())
                .then((data) => {
                    submitForm.reset();
                    toastr.success('Message Send');

                })
                .catch((error) => {
                    console.error('Error', error);
                })

        }
    </script>
}